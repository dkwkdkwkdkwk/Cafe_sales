import pandas as pd
from sqlalchemy import create_engine
from dotenv import load_dotenv
import os

# ✅ 환경변수 로딩
load_dotenv()
db_url = os.getenv("DATABASE_URL")
engine = create_engine(db_url)

# ✅ 자치구 카페수 데이터 생성
data = {
    "자치구": [
        "중구", "종로구", "용산구", "성동구", "금천구", "강북구", "도봉구", "서대문구", "광진구",
        "마포구", "영등포구", "동작구", "서초구", "성북구", "양천구", "동대문구", "중랑구",
        "관악구", "강동구", "구로구", "강서구", "노원구", "강남구", "은평구", "송파구"
    ],
    "소계": [
        130418, 149478, 216537, 281062, 238431, 288797, 305391, 318085, 348660,
        371852, 396834, 386897, 412715, 433569, 432901, 361950, 384320,
        497213, 500002, 410727, 560094, 495111, 563189, 464466, 654127
    ],
    "카페수": [
        282, 288, 270, 275, 214, 258, 261, 256, 272,
        260, 268, 257, 269, 270, 257, 213, 207,
        266, 260, 211, 261, 223, 249, 202, 276
    ],
    "인구수당_카페비율": [
        21.62, 19.27, 12.47, 9.78, 8.98, 8.93, 8.55, 8.05, 7.80,
        6.99, 6.75, 6.64, 6.52, 6.23, 5.94, 5.88, 5.39,
        5.35, 5.20, 5.14, 4.66, 4.50, 4.42, 4.35, 4.22
    ]
}

df = pd.DataFrame(data)

# ✅ DB에 저장
df.to_sql("district_cafe_ratio", con=engine, if_exists="replace", index=False)

print("✅ 자치구별 카페 수 비율 테이블 district_cafe_ratio 저장 완료!")
